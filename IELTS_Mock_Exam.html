<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IELTS Advanced Mock Test | Teacher Ivan</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Merriweather:ital,wght@0,300;0,400;1,300&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    
    <style>
        :root {
            /* Paleta Oficial del HUB */
            --primary-teal: #5dcbc3;
            --primary-dark: #3aa39b;
            --accent-coral: #ff9a8b;
            --text-dark: #2d2d2d;
            --bg-light: #f9f9f9;
            --white: #ffffff;
            --shadow: 0 10px 30px rgba(0,0,0,0.05);
            --radius: 20px;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
            margin: 0; padding: 0;
            padding-bottom: 60px;
        }

        /* --- HEADER --- */
        header {
            background: var(--white);
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 4px solid var(--primary-teal);
        }

        .header-left { display: flex; align-items: center; gap: 20px; }
        .back-link { text-decoration: none; color: #999; font-weight: 600; font-size: 0.9rem; transition: 0.2s; }
        .back-link:hover { color: var(--primary-teal); }
        
        h1 { margin: 0; font-size: 1.4rem; font-weight: 700; color: var(--text-dark); display: flex; align-items: center; gap: 10px; }
        .ielts-badge { background: var(--accent-coral); color: white; padding: 4px 10px; border-radius: 8px; font-size: 0.8rem; letter-spacing: 1px; }

        .timer-badge {
            background: #f0fdfc; color: var(--primary-dark); padding: 8px 20px; border-radius: 50px;
            font-weight: 700; font-size: 1.2rem; border: 2px solid var(--primary-teal);
            display: flex; align-items: center; gap: 8px;
        }

        /* --- TABS --- */
        .container { max-width: 900px; margin: 40px auto; padding: 0 20px; }
        
        .tabs { 
            display: flex; gap: 10px; margin-bottom: 30px; flex-wrap: wrap; justify-content: center;
        }
        .tab-btn {
            padding: 12px 25px; background: white; border: 2px solid transparent; cursor: pointer;
            font-weight: 600; color: #aaa; border-radius: 50px; transition: 0.3s;
            font-family: 'Poppins', sans-serif; box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        .tab-btn.active { background: var(--primary-teal); color: white; transform: translateY(-2px); box-shadow: 0 8px 15px rgba(93, 203, 195, 0.3); }
        .tab-btn:disabled { opacity: 0.5; cursor: not-allowed; background: #eee; box-shadow: none; }

        /* --- SECTIONS --- */
        .section-card {
            background: white; padding: 40px; border-radius: var(--radius);
            box-shadow: var(--shadow); display: none; border-top: 8px solid var(--primary-teal);
        }
        .section-card.active { display: block; animation: fadeIn 0.5s ease; }

        h2 { color: var(--text-dark); font-size: 1.8rem; margin-top: 0; margin-bottom: 20px; }
        
        .instruction-box { 
            background: #f0fdfc; padding: 20px; border-radius: 12px; margin-bottom: 30px; 
            border-left: 5px solid var(--primary-teal); font-size: 0.95rem; color: #444;
        }

        /* --- CONTENT STYLES --- */
        .academic-text {
            font-family: 'Merriweather', serif; line-height: 1.9; color: #333;
            background: #fafafa; padding: 30px; border: 1px solid #eee; margin-bottom: 30px;
            max-height: 450px; overflow-y: auto; border-radius: 12px; font-size: 1.05rem;
        }
        .academic-text h3 { font-family: 'Poppins', sans-serif; color: var(--text-dark); margin-top: 0; }

        .video-wrapper {
            position: relative; padding-bottom: 56.25%; height: 0; margin-bottom: 30px;
            border-radius: 15px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .video-wrapper iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }

        /* --- QUESTIONS & FORMS --- */
        .question-block { margin-bottom: 25px; padding-bottom: 20px; border-bottom: 1px dashed #eee; }
        .q-label { font-weight: 600; margin-bottom: 15px; display: block; font-size: 1.1rem; color: var(--text-dark); }
        
        input[type="text"] {
            width: 100%; max-width: 300px; padding: 12px 20px; border: 2px solid #ddd; 
            border-radius: 50px; font-family: 'Poppins', sans-serif; font-size: 1rem;
            outline: none; transition: 0.3s;
        }
        input[type="text"]:focus { border-color: var(--primary-teal); background: #f0fdfc; }
        
        .radio-group label { 
            display: block; margin: 10px 0; cursor: pointer; background: #f9f9f9; 
            padding: 12px 20px; border-radius: 10px; border: 1px solid #eee; transition: 0.2s;
        }
        .radio-group label:hover { background: #f0fdfc; border-color: var(--primary-teal); }
        .radio-group input[type="radio"] { margin-right: 10px; accent-color: var(--primary-teal); transform: scale(1.2); }

        textarea { 
            width: 100%; height: 250px; padding: 20px; border: 2px solid #ddd; 
            border-radius: 15px; font-family: 'Poppins', sans-serif; font-size: 1rem; 
            resize: vertical; outline: none; transition: 0.3s; box-sizing: border-box; background: #fafafa;
        }
        textarea:focus { border-color: var(--primary-teal); background: white; }

        /* --- BUTTONS --- */
        .btn-main {
            background: var(--text-dark); color: white; border: none; padding: 15px 40px;
            border-radius: 50px; font-weight: bold; cursor: pointer; float: right; margin-top: 20px;
            font-family: 'Poppins', sans-serif; font-size: 1rem; transition: 0.3s;
            display: inline-flex; align-items: center; gap: 8px;
        }
        .btn-main:hover { background: black; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .btn-coral { background: var(--accent-coral); }
        .btn-coral:hover { background: #ff7e6b; }

        /* --- SCORE DASHBOARD --- */
        .score-dashboard {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; text-align: center; margin-bottom: 40px;
        }
        .score-card { background: #f0fdfc; padding: 30px 20px; border-radius: 15px; border: 1px solid #e0f2f1; }
        .score-num { font-size: 3rem; font-weight: 700; color: var(--primary-teal); display: block; line-height: 1; margin-bottom: 10px; }
        .score-label { font-weight: 600; color: #555; text-transform: uppercase; letter-spacing: 1px; font-size: 0.85rem; }

        .model-answer { background: #fff0f3; padding: 25px; border-radius: 15px; border-left: 5px solid var(--accent-coral); margin-top: 20px; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        /* CLR FIX */
        .clearfix::after { content: ""; clear: both; display: table; }

    </style>
</head>
<body>

<header>
    <div class="header-left">
        <a href="index.html" class="back-link">‚Üê HUB</a>
        <h1><span class="ielts-badge">IELTS</span> Mock Exam</h1>
    </div>
    <div class="timer-badge" id="timer">
        <span class="material-icons-round">timer</span> 45:00
    </div>
</header>

<div class="container">

    <div class="tabs">
        <button class="tab-btn active" id="tabListening">1. Listening</button>
        <button class="tab-btn" id="tabReading" onclick="switchTab('reading')" disabled>2. Reading</button>
        <button class="tab-btn" id="tabWriting" onclick="switchTab('writing')" disabled>3. Writing</button>
        <button class="tab-btn" id="tabResults" disabled>4. Results</button>
    </div>

    <div id="sectionListening" class="section-card active clearfix">
        <h2>Listening Comprehension</h2>
        <div class="instruction-box">
            <span class="material-icons-round" style="vertical-align: middle; margin-right: 5px; color: var(--primary-teal);">info</span>
            <strong>Instructions:</strong> Watch the TED Talk by Anthony Goldbloom about "The Future of Work". Answer the questions 1-4. You can only play the video once to simulate exam conditions.
        </div>

        <div class="video-wrapper">
            <iframe src="https://www.youtube.com/embed/gWmRkYsLzB4" allowfullscreen></iframe>
        </div>

        <form id="listeningForm">
            <div class="question-block">
                <span class="q-label">1. According to the speaker, machine learning allows computers to perform tasks that previously only __________ could do.</span>
                <input type="text" id="l_q1" placeholder="Type one word...">
            </div>

            <div class="question-block">
                <span class="q-label">2. In the past, we could only automate tasks that we could __________.</span>
                <input type="text" id="l_q2" placeholder="Type one word...">
            </div>

            <div class="question-block">
                <span class="q-label">3. The speaker gives the example of grading essays. He implies that machines can grade them:</span>
                <div class="radio-group">
                    <label><input type="radio" name="l_q3" value="A"> A) Better than humans.</label>
                    <label><input type="radio" name="l_q3" value="B"> B) Instantly and for free.</label>
                    <label><input type="radio" name="l_q3" value="C"> C) With more creativity.</label>
                </div>
            </div>

            <div class="question-block">
                <span class="q-label">4. What is the "Novelty Frequency" mentioned?</span>
                <div class="radio-group">
                    <label><input type="radio" name="l_q4" value="A"> A) How often a job requires tackling new situations.</label>
                    <label><input type="radio" name="l_q4" value="B"> B) How often machines break down.</label>
                    <label><input type="radio" name="l_q4" value="C"> C) The speed of internet connection.</label>
                </div>
            </div>
        </form>

        <button class="btn-main" onclick="nextSection('reading')">Continue to Reading ‚ûú</button>
    </div>

    <div id="sectionReading" class="section-card clearfix">
        <h2>Academic Reading</h2>
        <div class="instruction-box">
            <span class="material-icons-round" style="vertical-align: middle; margin-right: 5px; color: var(--primary-teal);">menu_book</span>
            <strong>Instructions:</strong> Read the text "The Paradox of Automation" and answer questions 5-8. Select True, False, or Not Given.
        </div>

        <div class="academic-text">
            <h3>The Paradox of Automation</h3>
            <p><strong>Paragraph A</strong><br>
            As artificial intelligence systems become more sophisticated, a counter-intuitive phenomenon has emerged: the more efficient the automated system, the more crucial the human contribution of the operator becomes. This is known as the "Paradox of Automation." When a system handles 99% of the routine workload, the human operator is prone to complacency and "skill fade." However, when the remaining 1% of critical errors occur, the operator must intervene immediately, often in complex situations they are no longer practiced in handling.</p>
            
            <p><strong>Paragraph B</strong><br>
            A seminal study by James Reason in 1997 highlighted that manual skills deteriorate rapidly when not exercised. Airline pilots, for example, who rely heavily on autopilot, may find their manual flying skills degraded during an emergency. This suggests that while AI increases general efficiency, it potentially increases the catastrophic risk of "black swan" events where human intuition is the only safeguard.</p>
            
            <p><strong>Paragraph C</strong><br>
            Furthermore, the economic implications are stark. While automation advocates promise a leisure society, recent data suggests a polarization of the workforce. High-skill jobs that require managing AI are seeing wage growth, while middle-skill routine jobs are evaporating. The result is not mass unemployment, but rather an "hourglass economy" with a hollowed-out middle class.</p>
        </div>

        <form id="readingForm">
            <div class="question-block">
                <span class="q-label">5. The "Paradox of Automation" implies that human operators become less important as systems improve.</span>
                <div class="radio-group">
                    <label><input type="radio" name="r_q5" value="TRUE"> True</label>
                    <label><input type="radio" name="r_q5" value="FALSE"> False</label>
                    <label><input type="radio" name="r_q5" value="NOT GIVEN"> Not Given</label>
                </div>
            </div>

            <div class="question-block">
                <span class="q-label">6. James Reason's study focused exclusively on the automotive industry.</span>
                <div class="radio-group">
                    <label><input type="radio" name="r_q6" value="TRUE"> True</label>
                    <label><input type="radio" name="r_q6" value="FALSE"> False</label>
                    <label><input type="radio" name="r_q6" value="NOT GIVEN"> Not Given</label>
                </div>
            </div>

            <div class="question-block">
                <span class="q-label">7. An "hourglass economy" refers to a situation where the middle class is disappearing.</span>
                <div class="radio-group">
                    <label><input type="radio" name="r_q7" value="TRUE"> True</label>
                    <label><input type="radio" name="r_q7" value="FALSE"> False</label>
                    <label><input type="radio" name="r_q7" value="NOT GIVEN"> Not Given</label>
                </div>
            </div>

            <div class="question-block">
                <span class="q-label">8. Airline pilots are strictly forbidden from using autopilot during takeoff.</span>
                <div class="radio-group">
                    <label><input type="radio" name="r_q8" value="TRUE"> True</label>
                    <label><input type="radio" name="r_q8" value="FALSE"> False</label>
                    <label><input type="radio" name="r_q8" value="NOT GIVEN"> Not Given</label>
                </div>
            </div>
        </form>

        <button class="btn-main" onclick="nextSection('writing')">Continue to Writing ‚ûú</button>
    </div>

    <div id="sectionWriting" class="section-card clearfix">
        <h2>Writing Task 2 (Essay)</h2>
        <div class="instruction-box">
            <span class="material-icons-round" style="vertical-align: middle; margin-right: 5px; color: var(--primary-teal);">edit_document</span>
            <strong>Task:</strong> Write about the following topic. You should write at least 250 words.
        </div>

        <div style="background:var(--bg-light); border:2px dashed #ccc; padding:25px; border-radius: 12px; margin-bottom:25px;">
            <p style="font-size: 1.1rem; margin-top:0;"><strong>Some experts believe that Artificial Intelligence will eventually result in a society where humans no longer need to work. Others believe it will lead to mass unemployment and social unrest.</strong></p>
            <p style="color:#666; margin-bottom:0;"><em>Discuss both these views and give your own opinion.</em></p>
        </div>

        <textarea id="essayInput" placeholder="Start typing your essay here..."></textarea>
        <div style="text-align:right; font-size:0.9rem; color:#888; margin-top:10px; font-weight:600;">Word Count: <span id="wordCount" style="color:var(--primary-teal);">0</span></div>

        <button class="btn-main btn-coral" onclick="finishExam()">Finish Exam & Get Report <span class="material-icons-round">flag</span></button>
    </div>

    <div id="sectionResults" class="section-card clearfix">
        <h2 style="border:none; text-align:center;">Exam Completed üéâ</h2>
        <p style="text-align:center; color:#666; margin-bottom: 40px;">Here is your personalized performance report.</p>

        <div class="score-dashboard">
            <div class="score-card">
                <span class="score-num" id="scoreListening">-</span>
                <span class="score-label">Listening</span>
            </div>
            <div class="score-card">
                <span class="score-num" id="scoreReading">-</span>
                <span class="score-label">Reading</span>
            </div>
            <div class="score-card" style="background:#fff0f3; border-color:#ffebee;">
                <span class="score-num" style="color:var(--accent-coral);" id="scoreOverall">-</span>
                <span class="score-label">Overall (Obj)</span>
            </div>
        </div>

        <h3 style="margin-top:40px;">Writing Feedback (Self-Correction)</h3>
        <p style="color:#666;">Compare your essay with this Band 9.0 Model Answer:</p>
        
        <div style="display:flex; flex-wrap:wrap; gap:20px; margin-bottom:40px;">
            <div style="flex:1; min-width:300px; background:#f9f9f9; padding:20px; border-radius:12px; border:1px solid #ddd;">
                <strong style="color:var(--primary-dark);">Your Essay:</strong>
                <p id="studentEssayDisplay" style="white-space: pre-wrap; font-size:0.95rem; color:#444;">...</p>
            </div>
            <div class="model-answer" style="flex:1; min-width:300px;">
                <strong style="color:var(--accent-coral);">Band 9.0 Model Answer:</strong>
                <p style="font-size:0.95rem; line-height: 1.7; color:#444;">The rise of Artificial Intelligence (AI) has ignited a fierce debate regarding the future of the workforce. While optimists envision a utopian leisure society liberated from toil, pessimists warn of economic collapse due to job displacement. In my view, while the transition will be turbulent, AI is more likely to transform jobs rather than eliminate them entirely...</p>
                <div style="background:white; padding:10px; border-radius:8px; font-size:0.85rem; color:#666; margin-top:15px;">
                    <strong>Teacher's Note:</strong> Notice the high-level vocabulary used: "ignited a fierce debate", "utopian leisure society", and "turbulent". The essay balances both views clearly before stating a firm opinion.
                </div>
            </div>
        </div>

        <div style="text-align:center; background:#f4f7f6; padding:30px; border-radius:15px;">
            <h3 style="margin-top:0;">Download Official Report</h3>
            <input type="text" id="studentName" placeholder="Enter Full Name..." style="margin-bottom:15px; text-align:center;">
            <br>
            <button class="btn-main" style="float:none; margin:0;" onclick="generatePDF()"><span class="material-icons-round">download</span> Save PDF Report</button>
        </div>
    </div>

</div>

<script>
    // --- TIMER LOGIC ---
    let timeLeft = 45 * 60; // 45 minutes
    const timerEl = document.getElementById('timer');
    
    const timerInterval = setInterval(() => {
        timeLeft--;
        const m = Math.floor(timeLeft / 60);
        const s = timeLeft % 60;
        timerEl.innerHTML = `<span class="material-icons-round">timer</span> ${m}:${s < 10 ? '0'+s : s}`;
        
        if(timeLeft <= 0) {
            clearInterval(timerInterval);
            alert("Time is up! Submitting exam...");
            finishExam();
        }
    }, 1000);

    // --- NAVIGATION ---
    function nextSection(nextId) {
        // Unlock tab
        const tab = document.getElementById('tab' + nextId.charAt(0).toUpperCase() + nextId.slice(1));
        tab.disabled = false;
        
        switchTab(nextId);
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function switchTab(sectionId) {
        document.querySelectorAll('.section-card').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
        
        document.getElementById('section' + sectionId.charAt(0).toUpperCase() + sectionId.slice(1)).classList.add('active');
        document.getElementById('tab' + sectionId.charAt(0).toUpperCase() + sectionId.slice(1)).classList.add('active');
    }

    // --- WORD COUNT ---
    document.getElementById('essayInput').addEventListener('input', function() {
        const words = this.value.trim().split(/\s+/).filter(word => word.length > 0).length;
        document.getElementById('wordCount').innerText = words;
    });

    // --- SCORING ENGINE ---
    function finishExam() {
        clearInterval(timerInterval);
        
        // 1. Calculate Listening
        let l_score = 0;
        const l_answers = { l_q1: "humans", l_q2: "explain", l_q3: "B", l_q4: "A" };
        
        if(document.getElementById('l_q1').value.toLowerCase().trim() === l_answers.l_q1) l_score++;
        if(document.getElementById('l_q2').value.toLowerCase().trim() === l_answers.l_q2) l_score++;
        if(document.querySelector('input[name="l_q3"]:checked')?.value === l_answers.l_q3) l_score++;
        if(document.querySelector('input[name="l_q4"]:checked')?.value === l_answers.l_q4) l_score++;

        let l_band = (l_score / 4) * 9;
        
        // 2. Calculate Reading
        let r_score = 0;
        const r_answers = { r_q5: "FALSE", r_q6: "NOT GIVEN", r_q7: "TRUE", r_q8: "FALSE" };

        if(document.querySelector('input[name="r_q5"]:checked')?.value === r_answers.r_q5) r_score++;
        if(document.querySelector('input[name="r_q6"]:checked')?.value === r_answers.r_q6) r_score++;
        if(document.querySelector('input[name="r_q7"]:checked')?.value === r_answers.r_q7) r_score++;
        if(document.querySelector('input[name="r_q8"]:checked')?.value === r_answers.r_q8) r_score++;

        let r_band = (r_score / 4) * 9;

        // 3. Display Results
        document.getElementById('scoreListening').innerText = l_band.toFixed(1);
        document.getElementById('scoreReading').innerText = r_band.toFixed(1);
        document.getElementById('scoreOverall').innerText = ((l_band + r_band)/2).toFixed(1);
        
        const essayContent = document.getElementById('essayInput').value.trim();
        document.getElementById('studentEssayDisplay').innerText = essayContent === "" ? "(No essay submitted)" : essayContent;

        // Unlock Results Tab
        const resTab = document.getElementById('tabResults');
        resTab.disabled = false;
        switchTab('results');
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // --- PDF GENERATOR ---
    function generatePDF() {
        const name = document.getElementById('studentName').value.trim();
        if(!name) { alert("Please enter your name before downloading."); return; }

        const element = document.createElement('div');
        element.innerHTML = `
            <div style="font-family: 'Helvetica', sans-serif; padding: 40px; color: #2d2d2d;">
                <h1 style="color:#5dcbc3; border-bottom: 2px solid #eee; padding-bottom: 10px; margin-top:0;">IELTS Simulation Report</h1>
                <p><strong>Student:</strong> ${name}</p>
                <p><strong>Date:</strong> ${new Date().toLocaleDateString()}</p>
                <br>
                <h3 style="color:#ff9a8b; margin-bottom:10px;">Objective Scores</h3>
                <table style="width:100%; border-collapse: collapse; margin-bottom: 30px;">
                    <tr>
                        <td style="padding:10px; border:1px solid #ddd; background:#f9f9f9; width:50%;"><strong>Listening:</strong></td>
                        <td style="padding:10px; border:1px solid #ddd; text-align:center;">${document.getElementById('scoreListening').innerText} / 9.0</td>
                    </tr>
                    <tr>
                        <td style="padding:10px; border:1px solid #ddd; background:#f9f9f9;"><strong>Reading:</strong></td>
                        <td style="padding:10px; border:1px solid #ddd; text-align:center;">${document.getElementById('scoreReading').innerText} / 9.0</td>
                    </tr>
                </table>
                
                <h3 style="color:#ff9a8b; margin-bottom:10px;">Writing Task 2 Submission</h3>
                <div style="background:#f9f9f9; padding:20px; border-radius:10px; border:1px solid #eee; white-space: pre-wrap; font-size: 0.95rem; line-height: 1.6;">
                    ${document.getElementById('essayInput').value || "No essay submitted."}
                </div>
                
                <p style="font-size:0.8em; color:#999; text-align: center; margin-top: 50px;">Generated by Teacher Ivan's IELTS Hub ‚Ä¢ 2026</p>
            </div>
        `;

        html2pdf().set({
            margin: 0.5,
            filename: `IELTS_Report_${name.replace(/\s+/g, '_')}.pdf`,
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 2 },
            jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
        }).from(element).save();
    }
</script>

</body>
</html>